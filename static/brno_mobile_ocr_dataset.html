{% extends 'template.html' %}

{% block header %}
  Brno Mobile OCR Dataset
{% endblock %}

{% block content %}
<h2>About the dataset</h2>
<p>
    Brno Mobile OCR Dataset (B-MOD) is a collection of 2&nbsp;113 templates (pages of scientific papers). 
    Those templates were captured using 23 various mobile devices under unrestricted conditions ensuring that the obtained photographs contain various amount of blurriness, illumination etc.
    In total, the dataset contains 19&nbsp;725 photographs from which more than 500k lines with precise transcriptions was extracted.
    The templates were divided into three subsets (training, validation and testing).
    Captured photographs and cropped lines follows this division so photographs of the same templates and lines extracted from them are in the same subset. 
</p>
<p>
    On this webpage, you can download entire dataset (original templates, captured photographs with annotations in PAGE XML format, transformed photographs with annotations in PAGE XML format and cropped lines with transcriptions). 
    Also you can evaluate your OCR system using the evaluation form below.
    Underneath the evaluation form you can find table with results of evaluated transcriptions.
    If you have any question, please contact ikiss@fit.vutbr.cz or ihradis@fit.vutbr.cz.
</p>

<h2>Download</h2>
<p>Within the Brno Mobile OCR Dataset, you can download:</p>
<ul>
    <li><a class="dotted-link" href="https://www.fit.vutbr.cz/~ikiss/b-mod/b-mod_templates.zip">Templates</a> (1.45 GB)</li>
    <li><a class="dotted-link" href="https://www.fit.vutbr.cz/~ikiss/b-mod/b-mod_photos_and_xmls_untransformed.zip">Untransformed PAGE XML and photos</a> (31.62 GB)</li>
    <li><a class="dotted-link" href="https://www.fit.vutbr.cz/~ikiss/b-mod/b-mod_photos_and_xmls_transformed.zip">Transformed PAGE XML and photos</a> (87.45 GB)</li>
    <li><a class="dotted-link" href="https://www.fit.vutbr.cz/~ikiss/b-mod/b-mod_lines.zip">Cropped lines with transcriptions</a> (5.29 GB)</li>
</ul>

<h2>Evaluate</h2>
<p>
    You can evaluate your OCR system using the form below.
    Please, upload a single text file where each line corresponds to one transcribed line with the same formatting as in the downloaded ZIP archive.
    The formating must follow pattern "filename transcription", eg. 
</p>
<form id="bmod_upload_form" method="POST" action="/brno_mobile_ocr_dataset" enctype="multipart/form-data">
    <p>
        <div class="input-group">
            <input type="text" name="bmod_upload_name" id="bmod_upload_name" class="form-control" placeholder="Name (required)" />
            <input type="text" name="bmod_upload_description" id="bmod_upload_description" class="form-control" placeholder="Short description (optional)" />
        </div>
    </p>

    <p>
        <div class="input-group">
            <div class="custom-file">
                <input type="file" class="custom-file-input" name="bmod_uploaded_transcription_file" id="bmod_upload_file_input" aria-describedby="bmod_upload_file_input">
                <label class="custom-file-label" id="bmod_upload_label" for="bmod_upload_file_input">Choose file</label>
            </div>

            <span class="input-group-text" id="bmod_upload_button" onclick="uploadBMODTranscriptionFile()">Upload</span>
        </div>
    </p>
</form>

<div id="error_block" {% if success is not defined or success == true %} class="hidden" {% endif %}>
    <p id="bmod_upload_form_no_file_message">Please, select a file.</p>
    <p id="bmod_upload_form_empty_name_message">Please, fill your name or name of your team.</p>

    {% if success is defined and success == false %}
        {% if message is defined and message|length > 0 %}
            <p>{{ message }}</p>
        {% else %}
            <p>Something unexpectedly failed. Please, report this to ikiss@fit.vutbr.cz.</p>
        {% endif %}
    {% endif %}
</div>

<div id="success_block" {% if success is not defined or success == false %} class="hidden" {% endif %}>
    {% if success is defined and success == true %}
        {% if message is defined and message|length > 0 %}
            <p>{{ message }}</p>
        {% endif %}
    {% endif %}
</div>

<h2>Leaderboard</h2>

    {% if evaluation_results is defined %}
        <table class="results">
            <thead>
                <tr>
                    <td rowspan="2">Name</td>
                    <td rowspan="2">Description</td>
                    <td rowspan="2">Date</td>
                    <td colspan="2">Easy</td>
                    <td colspan="2">Medium</td>
                    <td colspan="2">Hard</td>
                    <td colspan="2">Overall</td>
                </tr>
                <tr>
                    <td>CER</td>
                    <td>WER</td>
                    <td>CER</td>
                    <td>WER</td>
                    <td>CER</td>
                    <td>WER</td>
                    <td>CER</td>
                    <td>WER</td>
                </tr>
            </thead>
            <tbody>
            {% for evaluation_result in evaluation_results %}
                <tr>
                    <td>{{evaluation_result.name}}</td>
                    <td>{{evaluation_result.description}}</td>
                    <td>{{evaluation_result.date}}</td>
                    <td>{{evaluation_result.cer_easy}}</td>
                    <td>{{evaluation_result.wer_easy}}</td>
                    <td>{{evaluation_result.cer_medium}}</td>
                    <td>{{evaluation_result.wer_medium}}</td>
                    <td>{{evaluation_result.cer_hard}}</td>
                    <td>{{evaluation_result.wer_hard}}</td>
                    <td>{{evaluation_result.cer_overall}}</td>
                    <td>{{evaluation_result.wer_overall}}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>Could not parse data!</p>
    {% endif %}

{% endblock %}
